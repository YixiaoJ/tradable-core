/******  Copyright 2016 Tradable ApS; @license MIT; v1.14  ******/
var trEmbJQ=jQuery.noConflict(!0),jsGlobalObject="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:this;!function(e,n){"use strict";function t(){function e(e,t){var r,c,i;t.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+v,!1);var a=e.replace("#","").split("&");return n(a).each(function(e,n){var t=n.split("="),o=t[0],a=t[1];"access_token"===o?r=a:"endpointURL"===o?c=a:"expires_in"===o&&(i=a)}),r&&c?(t.enableTrading(r,c,i),"osLaunch"===window.name&&window.close(),!0):!1}var t=!1,r=window.opener;if(r&&"osBrokerSignUp"===window.name)window.close();else if(r&&"osLaunch"===window.name){var c=window.location.hash;if(c){try{r.postMessage("replace your location","*"),t=e(c,r.tradableEmbed)}catch(a){t=!1}t||(t=e(c,N))}}else window.location.hash&&-1!==window.location.hash.indexOf("access_token")&&-1!==window.location.hash.indexOf("endpointURL")&&-1!==window.location.hash.indexOf("expires_in")?t=e(window.location.hash,N):N.tradingEnabled&&(i(),t=!0);t||(console.log("Initiating without authentication..."),n(document).ready(function(){u()}))}function o(){var e="test";try{return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch(n){return!1}}function r(e,n){var t=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,r=420,c=500,i=t+window.innerWidth/2-r/2,a=o+window.innerHeight/2-c/2;return window.open(e,n,"toolbar=no, titlebar=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+r+", height="+c+", top="+a+", left="+i)}function c(e,t){var o=!1;return N.tradingEnabled&&(N.tradingEnabled=!1,o=!0),N.getInstruments().then(function(t){N.availableCategories.splice(0,N.availableCategories.length),N.availableInstruments.splice(0,N.availableInstruments.length),N.availableSymbols.splice(0,N.availableSymbols.length),N.availableCurrencies.splice(0,N.availableCurrencies.length);var r=["100","200","225","spx","h33","nas","u30","e50","f40","d30","e35","i40","z30","s30","uso","uko"];return n(t).each(function(e,t){if(N.availableInstruments.push(t),N.availableSymbols.push(t.symbol),"FOREX"===t.type&&6===t.symbol.length){var o=t.symbol.toLowerCase().substring(0,3),c=t.symbol.toLowerCase().substring(3,6);-1===n.inArray(o,N.availableCurrencies)&&-1===n.inArray(o,r)&&N.availableCurrencies.push(o),-1===n.inArray(c,N.availableCurrencies)&&-1===n.inArray(o,r)&&N.availableCurrencies.push(c)}-1===n.inArray(t.type,N.availableCategories)&&N.availableCategories.push(t.type)}),console.log("Instruments ready"),o&&(N.tradingEnabled=!0,p()),e&&"function"==typeof e?e(N.accounts):this},function(e){return t&&"function"==typeof t?t(e):this})}function i(){console.log("Validating token..."),N.getAccounts().then(function(e){N.enableTrading(N.accessToken,N.authEndpoint)},function(){N.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+v,N.tradingEnabled),u()})}function a(e,t){var r=new n.Deferred;console.log("Accounts initialized");var c,i=localStorage.getItem("selectedAccount:"+v),a=N.accounts.length-1;return c=e&&N.accounts.length>t?N.accounts[a].uniqueId:i&&N.accountMap[i]?i:N.accounts[a].uniqueId,N.setSelectedAccount(c,function(){N.tradingEnabled||(N.tradingEnabled=!0,o()&&localStorage.setItem("tradingEnabled:"+v,N.tradingEnabled),u()),r.resolve()},function(e){r.reject(e)}),r}function u(){n(N.readyCallbacks).each(function(e,n){n()}),f("embedReady"),N.notifiedCallbacks=!0}function s(){if(N.tradingEnabled&&!G&&(x.length>0||void 0!==typeof C.accountUpdated)){G=!0;var e=[];n(N.symbolKeysForAccountUpdates).each(function(t,o){var r=o.substring(0,o.indexOf(":"));-1===n.inArray(r,e)&&e.push(r)}),N.getSnapshot(e).then(function(e){N.lastSnapshot=e,n.each(x,function(n,t){t(e)}),f("accountUpdated",e),G=!1},function(){G=!1})}}function l(){N.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+v,!1),n(M).each(function(e,n){n()}),f("tokenExpired"),u()}function d(e){n(D).each(function(n,t){t(e)}),f("error",e)}function p(){n(q).each(function(e,n){n()}),f("accountSwitch")}function f(e,n){if(N.isEventValid(e)){if(void 0!==typeof C[e])for(var t in C[e])"undefined"!=typeof n?C[e][t](n):C[e][t]()}else console.error("Careful, can't notify '"+e+"', it's an invalid event name")}function g(e,n,t){return n||t?e.then(function(e){return"function"==typeof n?n(e):void 0},function(e,n,o){return"function"==typeof t?t(e,n,o):void 0}):e}function A(){var e=new n.Deferred;if(!N.tradingEnabled||N.selectedAccount.brokerId<0)return e.resolve(),e;var t={tokenValue:N.accessToken};return N.makeOsRequest("internal","POST","","signOut",t).then(function(){e.resolve()},function(){e.reject()}),e}function m(e){var n,t,o=0;if(0===e.length)return o;for(n=0;n<e.length;n++)t=e.charCodeAt(n),o=(o<<5)-o+t,o&=o;return o}function h(){return-1!=navigator.userAgent.indexOf("MSIE")||/rv:11.0/i.test(navigator.userAgent)}"undefined"!=typeof console&&"undefined"!=typeof console.log||(e.console={log:function(){}});var v,b,y="js-1.14",T=location.href;if("undefined"!=typeof tradableEmbedConfig)v=tradableEmbedConfig.appId,b=tradableEmbedConfig.customOAuthURL,tradableEmbedConfig.redirectURI&&(T=tradableEmbedConfig.redirectURI);else{var E="tradable-embed";0===n("#"+E).length&&(E="tradable-api"),v=n("#"+E).attr("data-app-id"),b=n("#"+E).attr("data-custom-oauth-url");var I=n("#"+E).attr("data-redirect-uri");I&&(T=I)}T=encodeURIComponent(T);var O="api.tradable.com/";v>2e5&&(O="api-staging.tradable.com/",console.log("Starting in staging mode..."));var P="https://"+O+"oauth/authorize?client_id="+v+"&scope=trade&response_type=token&redirect_uri="+T,k=b?b:P,S=localStorage.getItem("accessToken:"+v),R=localStorage.getItem("authEndpoint:"+v),w=localStorage.getItem("tradingEnabled:"+v),F=localStorage.getItem("expirationTimeUTC:"+v);!w||R&&S&&F||(w=!1,o()&&localStorage.setItem("tradingEnabled:"+v,w));var U=["embedReady","accountUpdated","accountSwitch","tokenExpired","tokenWillExpire","error"],C={},q=[],x=[],L=[],M=[],_=[],D=[],G=!1,N={app_id:v,oauth_host:O,auth_loc:k,login_loc:k+"&showLogin=true",approval_page_loc:k+"&showApproval=true",broker_signup_loc:"https://"+O+"brokerSignup?client_id="+v+"&redirect_uri="+T,auth_window:null,authEndpoint:R,accessToken:S,notifiedCallbacks:!1,tradingEnabled:w,expirationTimeUTC:F,readyCallbacks:[],allAccounts:[],accounts:[],accountIdsToExclude:[],accountMap:{},selectedAccount:null,selectedAccountId:null,availableCategories:[],availableInstruments:[],availableSymbols:[],availableCurrencies:[],lastSnapshot:null,symbolKeysForAccountUpdates:[],accountUpdateMillis:700,authenticate:function(e){N.tradingEnabled?i():N.openOAuthPage("AUTHENTICATE",!0,e)},authenticateWithWindow:function(e){N.openOAuthPage("AUTHENTICATE",!1,e)},showLoginPage:function(e){N.openOAuthPage("LOGIN",!0,e)},showLoginPageInWindow:function(e){N.openOAuthPage("LOGIN",!1,e)},showApprovalPage:function(){N.openOAuthPage("APPROVAL",!0)},showApprovalPageInWindow:function(){N.openOAuthPage("APPROVAL",!1)},showBrokerSignUpPage:function(){N.openOAuthPage("BROKER_SIGNUP",!0)},showBrokerSignUpPageInWindow:function(){N.openOAuthPage("BROKER_SIGNUP",!1)},openOAuthPage:function(e,n,t){var o="AUTHENTICATE"===e.toUpperCase()?N.auth_loc:"LOGIN"===e.toUpperCase()?N.login_loc:"APPROVAL"===e.toUpperCase()?N.approval_page_loc:"BROKER_SIGNUP"===e.toUpperCase()?N.broker_signup_loc:void 0;if(!o)return void console.error("Choose a correct type: AUTHENTICATE, LOGIN, APPROVAL or BROKER_SIGNUP");if("undefined"!=typeof t&&(o=o+"&broker_id="+t),"undefined"!=typeof n&&n||h())location.href=o;else{var c="BROKER_SIGNUP"===e.toUpperCase()?"osBrokerSignUp":"osLaunch";N.auth_window=r(o,c)}},enableWithAccessToken:function(e,n,t){N.enableTrading(e,n,t,!0)},signOut:function(){A(),o()&&(localStorage.removeItem("accessToken:"+v),localStorage.removeItem("authEndpoint:"+v),localStorage.removeItem("tradingEnabled:"+v),localStorage.removeItem("expirationTimeUTC:"+v)),N.tradingEnabled=!1,u()},isEventValid:function(e){return"string"==typeof e&&-1!==n.inArray(e,U)},on:function(e,n,t){if(!N.isEventValid(n))return void console.error("Plase provide a valid eventName: "+U);if(C[n]||(C[n]={}),"string"!=typeof e)return void console.error("The given event namespace is invalid (needs to be a string)");if("undefined"!=typeof C[n][e])return void console.error("The given event namespace is already taken, 'off' the event first to change it");if("function"!=typeof t)return void console.error("Please provide a valid callback function");switch(n){case"embedReady":N.initEmbedReady(t);break;case"accountUpdated":N.initAccountUpdated();break;case"tokenWillExpire":N.initTokenWillExpire()}C[n][e]=t},off:function(e,n){if("undefined"==typeof n)for(var t in C)e in C[t]&&delete C[t][e];else N.isEventValid(n)&&C[n]&&e in C[n]&&delete C[n][e]},initEmbedReady:function(e){N.notifiedCallbacks&&e()},onEmbedReady:function(e){N.readyCallbacks.push(e),N.initEmbedReady(e)},accountUpdateInterval:null,initAccountUpdated:function(){null===N.accountUpdateInterval&&(N.accountUpdateInterval=setInterval(s,N.accountUpdateMillis))},onAccountUpdated:function(e){if(e){N.initAccountUpdated();var t=m(e.toString());-1===n.inArray(t,L)&&(x.push(e),L.push(t))}},setAccountUpdateFrequencyMillis:function(e){e&&e>0&&"number"==typeof e?(N.accountUpdateMillis=e,N.accountUpdateInterval&&(clearInterval(N.accountUpdateInterval),N.accountUpdateInterval=setInterval(s,N.accountUpdateMillis))):console.error("Please specify a valid update frequency")},addSymbolToUpdates:function(e,t){if(-1!==e.indexOf(":"))return void console.error("It is not allowed to include a colon ':' in the updateClientId");var o=t+":"+e;-1===n.inArray(o,N.symbolKeysForAccountUpdates)&&-1!==n.inArray(t,N.availableSymbols)&&N.symbolKeysForAccountUpdates.push(o)},removeSymbolFromUpdates:function(e,t){var o=t+":"+e;N.symbolKeysForAccountUpdates=n.grep(N.symbolKeysForAccountUpdates,function(e){return e!=o})},onAccountSwitch:function(e){e&&-1===n.inArray(e,q)&&q.push(e)},onTokenExpired:function(e){e&&-1===n.inArray(e,M)&&M.push(e)},onError:function(e){-1===n.inArray(e,D)&&D.push(e)},tokenWillExpireInterval:null,initTokenWillExpire:function(){function e(){var e=N.getRemainingTokenMillis();e&&e>0&&18e5>e&&(n(_).each(function(n,t){t(e)}),f("tokenWillExpire",e))}null===N.tokenWillExpireInterval&&(N.tokenWillExpireInterval=setInterval(e,3e5))},onTokenWillExpire:function(e){N.initTokenWillExpire(),-1===n.inArray(e,_)&&_.push(e)},getRemainingTokenMillis:function(){return N.expirationTimeUTC||console.log("You need to authenticate before calling this method"),N.expirationTimeUTC-(new Date).getTime()},makeOsRequest:function(e,t,o,r,c,i,a){var u,s="internal"===e?"":"v1/";"user"!==e&&"accounts"!==e?u="https://"+O:void 0!==o&&null!==o&&0===o.length?u=N.authEndpoint:N.accountMap[o]?u=N.accountMap[o].endpointURL:console.info("Please specify a valid accountId or method");var p=n.ajax({type:t,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+N.accessToken),e.setRequestHeader("x-tr-embed-sdk",y)},crossDomain:!0,url:o&&o.length>0?u+s+e+"/"+o+"/"+r:u+s+e+"/"+r,contentType:"application/json; charset=utf-8",data:c?JSON.stringify(c):void 0,dataType:"json"});return p.then(function(){},function(e,n,t){e.responseJSON&&(403!==e.responseJSON.httpStatus&&502!==e.responseJSON.httpStatus||l(),d(e.responseJSON))}),i||a?p.then(function(e){return"function"==typeof i?i(e):void 0},function(e,n,t){return"function"==typeof a?a(e,n,t):void 0}):"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?Promise.resolve(p):p},makeAccountRequest:function(e,n,t,o,r,c){return N.makeOsRequest("accounts",e,n,t,o,r,c)},setSelectedAccount:function(e,n,t){return N.accountMap[e]?(N.lastSnapshot=void 0,N.selectedAccount=N.accountMap[e],N.selectedAccountId=e,console.log("New accountId is set"),c(function(){o()&&localStorage.setItem("selectedAccount:"+v,e),n&&n()},function(e){502!==e.status&&500!==e.status&&403!==e.status||(N.excludeCurrentAccount(),N.accounts.length>0?i():N.signOut()),t&&t(e)})):void console.error("Can't set account id to: "+e)},excludeCurrentAccount:function(){var e=N.selectedAccountId,n=N.accounts.indexOf(N.selectedAccount);n>-1&&N.accounts.splice(n,1),delete N.accountMap[e],N.accountIdsToExclude.push(e)},getInstrumentFromSymbol:function(e){if(!e)return null;var t=null;return n(N.availableInstruments).each(function(n,o){return o.symbol.toUpperCase()===e.toUpperCase()?(t=o,!1):void 0}),t},getInstrumentFromBrokerageAccountSymbol:function(e){var t=null;return n(N.availableInstruments).each(function(n,o){return o.brokerageAccountSymbol.toUpperCase()===e.toUpperCase()?(t=o,!1):void 0}),t},getAccountById:function(e){return N.accountMap[e]},getUser:function(e,n){return N.makeOsRequest("user","GET","","",null,e,n)},getAppInfo:function(e,n){return N.makeOsRequest("apps","GET","",N.app_id,null,e,n)},getBrokers:function(e,n){return N.makeOsRequest("brokers","GET","","",null,e,n)},authenticateWithCredentials:function(e,t,o,r,c){var i,a=new n.Deferred,u={appId:N.app_id,brokerId:e,login:t,password:o};return N.makeOsRequest("authenticate","POST","","",u).then(function(e){return i=e,N.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){a.resolve(i)},function(e){a.reject(e)}),g(a,r,c)},createDemoAccount:function(e,t,o){var r,c=new n.Deferred,i={appId:N.app_id,type:e};return N.makeOsRequest("createDemoAccount","POST","","",i).then(function(e){return r=e,N.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){c.resolve(r)},function(e){c.reject(e)}),g(c,t,o)},createForexDemoAccount:function(e,n){return N.createDemoAccount("FOREX",e,n)},createStocksDemoAccount:function(e,n){return N.createDemoAccount("STOCKS",e,n)},refreshAuthentication:function(e,t,o,r){var c=new n.Deferred,i={refreshTokenValue:e};t&&(i={refreshTokenValue:e,appSecret:t});var a;return N.makeOsRequest("refreshAuthentication","POST","","",i).then(function(e){return a=e,N.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){c.resolve(a)},function(e){c.reject(e)}),g(c,o,r)},getAccounts:function(e,t){var o=N.makeAccountRequest("GET","","",null).then(function(e){N.accounts.splice(0,N.accounts.length),N.allAccounts.splice(0,N.allAccounts.length),N.accountMap={},n(e.accounts).each(function(e,n){n.uniqueId&&"NA"!==n.uniqueId&&N.accountIdsToExclude.indexOf(n.uniqueId)<=-1&&(N.accounts.push(n),N.accountMap[n.uniqueId]=n),N.allAccounts.push(n)})});return g(o,e,t)},getCandles:function(e,n,t,o,r,c){return N.getCandlesForAccount(N.selectedAccountId,e,n,t,o,r,c)},getCandlesForAccount:function(e,n,t,o,r,c,i){var a={symbol:n,from:t,to:o,aggregation:r};return N.makeAccountRequest("POST",e,"candles/",a,c,i)},getSnapshot:function(e,n,t){return N.getSnapshotForAccount(N.selectedAccountId,e,n,t)},getSnapshotForAccount:function(e,n,t,o){var r={symbols:n};return N.makeAccountRequest("POST",e,"",r,t,o)},getInstruments:function(e,n){return N.getInstrumentsForAccount(N.selectedAccountId,e,n)},getInstrumentsForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"instruments/",null,n,t)},getMetrics:function(e,n){return N.getMetricsForAccount(N.selectedAccountId,e,n)},getMetricsForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"metrics/",null,n,t)},getOrders:function(e,n){return N.getOrdersForAccount(N.selectedAccountId,e,n)},getOrdersForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"orders/",null,n,t)},placeMarketOrder:function(e,n,t,o,r){return N.placeOrder(e,0,n,t,"MARKET",o,r)},placeMarketOrderForAccount:function(e,n,t,o,r,c){return N.placeOrderForAccount(e,n,0,t,o,"MARKET",r,c)},placeLimitOrder:function(e,n,t,o,r,c){return N.placeOrder(e,n,t,o,"LIMIT",r,c)},placeLimitOrderForAccount:function(e,n,t,o,r,c,i){return N.placeOrderForAccount(e,n,t,o,r,"LIMIT",c,i)},placeStopOrder:function(e,n,t,o,r,c){return N.placeOrder(e,n,t,o,"STOP",r,c)},placeStopOrderForAccount:function(e,n,t,o,r,c,i){return N.placeOrderForAccount(e,n,t,o,r,"STOP",c,i)},placeOrder:function(e,n,t,o,r,c,i){return N.placeOrderForAccount(N.selectedAccountId,e,n,t,o,r,c,i)},placeOrderForAccount:function(e,n,t,o,r,c,i,a){var u={amount:n,price:t,side:o,symbol:r,type:c};return N.makeAccountRequest("POST",e,"orders/",u,i,a)},placeOrderWithProtections:function(e,n,t,o,r,c,i,a,u){return N.placeOrderWithProtectionsForAccount(N.selectedAccountId,e,n,t,o,r,c,i,a,u)},placeOrderWithProtectionsForAccount:function(e,n,t,o,r,c,i,a,u,s){var l={amount:n,price:t,side:o,symbol:r,type:c};return i&&(l.takeProfitDistance=i),a&&(l.stopLossDistance=a),N.makeAccountRequest("POST",e,"orders/",l,u,s)},getPendingOrders:function(e,n){return N.getPendingOrdersForAccount(N.selectedAccountId,e,n)},getPendingOrdersForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"orders/pending",null,n,t)},getOrderById:function(e,n,t){return N.getOrderByIdForAccount(N.selectedAccountId,e,n,t)},getOrderByIdForAccount:function(e,n,t,o){return N.makeAccountRequest("GET",e,"orders/"+n,null,t,o)},modifyOrderPrice:function(e,n,t,o){return N.modifyOrderPriceForAccount(N.selectedAccountId,e,n,t,o)},modifyOrderPriceForAccount:function(e,n,t,o,r){var c={price:t};return N.makeAccountRequest("PUT",e,"orders/"+n,c,o,r)},cancelOrder:function(e,n,t){return N.cancelOrderForAccount(N.selectedAccountId,e,n,t)},cancelOrderForAccount:function(e,n,t,o){return N.makeAccountRequest("DELETE",e,"orders/"+n,null,t,o)},getPositions:function(e,n){return N.getPositionsForAccount(N.selectedAccountId,e,n)},getPositionsForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"positions/",null,n,t)},closeAllPositions:function(e,n){return N.closeAllPositionsForAccount(N.selectedAccountId,e,n)},closeAllPositionsForAccount:function(e,n,t){return N.makeAccountRequest("DELETE",e,"positions/",null,n,t)},getOpenPositions:function(e,n){return N.getOpenPositionsForAccount(N.selectedAccountId,e,n)},getOpenPositionsForAccount:function(e,n,t){return N.makeAccountRequest("GET",e,"positions/open",null,n,t)},getPositionById:function(e,n,t){return N.getPositionByIdForAccount(N.selectedAccountId,e,n,t)},getPositionByIdForAccount:function(e,n,t,o){return N.makeAccountRequest("GET",e,"positions/"+n,null,t,o)},reducePositionToAmount:function(e,n,t,o){return N.reducePositionToAmountForAccount(N.selectedAccountId,e,n,t,o)},reducePositionToAmountForAccount:function(e,n,t,o,r){var c={amount:t};return N.makeAccountRequest("PUT",e,"positions/"+n,c,o,r)},closePosition:function(e,n,t){return N.closePositionForAccount(N.selectedAccountId,e,n,t)},closePositionForAccount:function(e,n,t,o){return N.makeAccountRequest("DELETE",e,"positions/"+n,null,t,o)},addOrModifyProtections:function(e,n,t,o,r){return N.addOrModifyProtectionsForAccount(N.selectedAccountId,e,n,t,o,r)},addOrModifyProtectionsForAccount:function(e,n,t,o,r,c){var i={takeprofit:t,stoploss:o};return N.makeAccountRequest("PUT",e,"positions/"+n+"/protections/",i,r,c)},cancelProtections:function(e,n,t){return N.cancelProtectionsForAccount(N.selectedAccountId,e,n,t)},cancelProtectionsForAccount:function(e,n,t,o){return N.makeAccountRequest("DELETE",e,"positions/"+n+"/protections/",null,t,o)},addOrModifyTakeProfit:function(e,n,t,o){return N.makeProtectionRequest("PUT",e,n,"TAKEPROFIT",t,o)},addOrModifyTakeProfitForAccount:function(e,n,t,o,r){return N.makeProtectionRequestForAccount("PUT",e,n,t,"TAKEPROFIT",o,r)},addOrModifyStopLoss:function(e,n,t,o){return N.makeProtectionRequest("PUT",e,n,"STOPLOSS",t,o)},addOrModifyStopLossForAccount:function(e,n,t,o,r){return N.makeProtectionRequestForAccount("PUT",e,n,t,"STOPLOSS",o,r)},cancelTakeProfit:function(e,n,t){return N.makeProtectionRequest("DELETE",e,0,"TAKEPROFIT",n,t)},cancelTakeProfitForAccount:function(e,n,t,o){return N.makeProtectionRequestForAccount("DELETE",e,n,0,"TAKEPROFIT",t,o)},cancelStopLoss:function(e,n,t){return N.makeProtectionRequest("DELETE",e,0,"STOPLOSS",n,t)},cancelStopLossForAccount:function(e,n,t,o){return N.makeProtectionRequestForAccount("DELETE",e,n,0,"STOPLOSS",t,o)},makeProtectionRequest:function(e,n,t,o,r,c){return N.makeProtectionRequestForAccount(e,N.selectedAccountId,n,t,o,r,c)},makeProtectionRequestForAccount:function(e,n,t,o,r,c,i){var a={price:o};return"DELETE"===e&&(a=null),N.makeAccountRequest(e,n,"positions/"+t+"/protections/"+r,a,c,i)},getPrices:function(e,n,t){return N.getPricesForAccount(N.selectedAccountId,e,n,t)},getPricesForAccount:function(e,n,t,o){var r={symbols:n};return N.makeAccountRequest("POST",e,"prices/",r,t,o)},makeCandleRequest:function(e,t,o,r,c){var i={symbols:t};c&&(i=c);var a=n.ajax({type:"POST",crossDomain:!0,url:"https://candles-api.tradable.com/"+e,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),dataType:"json"});if(o||r)return a.then(function(e){return"function"==typeof o?o(e.dailyClose?e.dailyClose:e):void 0},function(e,n,t){return"function"==typeof r?r(e,n,t):void 0});var u=new n.Deferred;return a.then(function(e){return e.dailyClose?u.resolve(e.dailyClose):u.resolve(e)},function(e,n,t){return u.reject(e,n,t)}),"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?Promise.resolve(u.promise()):u.promise()},getLastDailyClose:function(e,n,t){return N.makeCandleRequest("dailyClose",e,n,t)},enableTrading:function(e,t,r,c){var i=new n.Deferred;console.log("Enabling Trading..."),N.tradingEnabled=!1,N.lastSnapshot=void 0,e&&t&&(N.accessToken=e,N.authEndpoint=t,o()&&(localStorage.setItem("accessToken:"+v,N.accessToken),localStorage.setItem("authEndpoint:"+v,N.authEndpoint),r&&(N.expirationTimeUTC=(new Date).getTime()+1e3*parseInt(r),localStorage.setItem("expirationTimeUTC:"+v,N.expirationTimeUTC))));var u=N.accounts.length;return N.getAccounts().then(function(e){return a(c,u)}).then(function(){i.resolve()},function(e){i.reject(e)}),i}};t(),e.trEmbJQ=trEmbJQ,e.tradableEmbed=N,"function"==typeof require&&"object"==typeof module&&module&&module.exports&&(module.exports=N)}(jsGlobalObject,trEmbJQ);