/******  Copyright 2016 Tradable ApS; @license MIT; v1.15.4  ******/
function isGreaterOrEqualMinVersion(e,n){return this.toNum=function(e){return parseInt(e,10)},this.highest=function(e,n){for(var t=e.split(".").map(this.toNum),o=n.split(".").map(this.toNum),r=0;r<t.length;r++)if(t[r]!=o[r])return t[r]>o[r]?e:n;return o.length>t.length?n:void 0},"undefined"==typeof highest(e,n)||highest(e,n)!==n}"undefined"==typeof jQuery?console.warn("tradableEmbed requires jQuery to run"):isGreaterOrEqualMinVersion(jQuery.fn.jquery,"2.1.4")||console.warn("tradableEmbed requires jQuery version 2.1.4 or above");var trEmbJQ=jQuery.noConflict(!0),jsGlobalObject="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:this;!function(e,n){"use strict";function t(){function e(e,t){var r,c,i;t.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+R,!1);var u=e.replace("#","").split("&");return n(u).each(function(e,n){var t=n.split("="),o=t[0],u=t[1];"access_token"===o?r=u:"endpointURL"===o?c=u:"expires_in"===o&&(i=u)}),r&&c?(t.enableTrading(r,c,i),"osLaunch"===window.name&&window.close(),!0):!1}var t=!1,r=window.opener;if(r&&"osBrokerSignUp"===window.name)window.close();else if(r&&"osLaunch"===window.name){var c=window.location.hash;if(c){try{r.postMessage("replace your location","*"),t=e(c,r.tradableEmbed)}catch(i){t=!1}t||(t=e(c,$))}}else window.location.hash&&-1!==window.location.hash.indexOf("access_token")&&-1!==window.location.hash.indexOf("endpointURL")&&-1!==window.location.hash.indexOf("expires_in")?t=e(window.location.hash,$):$.tradingEnabled&&(g(),t=!0);t||(console.log("Initiating without authentication..."),n(document).ready(function(){v()}))}function o(){var e="test";try{return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch(n){return!1}}function r(e,n){var t=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,r=420,c=500,i=t+window.innerWidth/2-r/2,u=o+window.innerHeight/2-c/2;return window.open(e,n,"toolbar=no, titlebar=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+r+", height="+c+", top="+u+", left="+i)}function c(e,n){var t=!1;return $.tradingEnabled&&($.tradingEnabled=!1,t=!0),f(),l().then(function(n){return console.log("Instruments ready"),t&&($.tradingEnabled=!0,E()),e&&"function"==typeof e?e($.accounts):this},function(e){return n&&"function"==typeof n?n(e):this})}function i(e,n){return u($.selectedAccountId,e,n)}function u(e,n,t){return $.makeAccountRequest("GET",e,"instruments/",null,n,t)}function a(){return"FULL_INSTRUMENT_LIST"===$.selectedAccount.instrumentRetrieval}function s(e){var t=!0;return n($.accounts).each(function(n,o){o.uniqueId===e&&"FULL_INSTRUMENT_LIST"!==o.instrumentRetrieval&&(t=!1)}),t}function l(){var e=new n.Deferred;if(a())i().then(function(n){m(n),e.resolve($.availableInstruments)});else{var t=[];Z=[],t.push($.searchInstruments("EUR").then(d)),t.push($.searchInstruments("AUD").then(d)),t.push($.searchInstruments("USD").then(d)),n.when.apply(null,t).done(function(){$.getPrices(Z).then(function(){e.resolve($.availableInstruments)})})}return e}function d(e){n(e).each(function(e,n){6!==n.symbol.length&&7!==n.symbol.length||Z.push(n.instrumentId)})}function f(){$.availableCategories.splice(0,$.availableCategories.length),$.availableInstruments.splice(0,$.availableInstruments.length),$.availableSymbols.splice(0,$.availableSymbols.length),$.availableCurrencies.splice(0,$.availableCurrencies.length),ee={}}function p(e){return"undefined"!=typeof ee[e]}function m(e){var t=["100","200","225","spx","h33","nas","u30","e50","f40","d30","e35","i40","z30","s30","uso","uko"];n(e).each(function(e,o){if(!p(o.instrumentId)){$.availableInstruments.push(o),$.availableSymbols.push(o.symbol);var r=o.symbol.replace("/","");if(("FOREX"===o.type||"CFD"===o.type)&&6===r.length){var c=r.toLowerCase().substring(0,3),i=r.toLowerCase().substring(3,6);-1===n.inArray(c,$.availableCurrencies)&&-1===n.inArray(c,t)&&$.availableCurrencies.push(c),-1===n.inArray(i,$.availableCurrencies)&&-1===n.inArray(c,t)&&$.availableCurrencies.push(i)}-1===n.inArray(o.type,$.availableCategories)&&$.availableCategories.push(o.type),ee[o.instrumentId]=!0}})}function h(){$.instrumentKeysForAccountUpdates.length&&$.instrumentKeysForAccountUpdates.splice(0,$.instrumentKeysForAccountUpdates.length)}function g(){console.log("Validating token..."),$.getAccounts().then(function(e){$.enableTrading($.accessToken,$.authEndpoint)},function(){$.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+R,$.tradingEnabled),v()})}function A(e,t){var r=new n.Deferred;console.log("Accounts initialized");var c,i=localStorage.getItem("selectedAccount:"+R),u=$.accounts.length-1;return c=e&&$.accounts.length>t?$.accounts[u].uniqueId:i&&$.accountMap[i]?i:$.accounts[u].uniqueId,h(),$.setSelectedAccount(c,function(){$.tradingEnabled||($.tradingEnabled=!0,o()&&localStorage.setItem("tradingEnabled:"+R,$.tradingEnabled),v()),r.resolve()},function(e){r.reject(e)}),r}function v(){n($.readyCallbacks).each(function(e,n){n()}),O("embedReady"),$.notifiedCallbacks=!0}function I(){if($.tradingEnabled&&!Y&&(J.length>0||void 0!==typeof B.accountUpdated)){Y=!0;var e=[];n($.instrumentKeysForAccountUpdates).each(function(t,o){var r=o.substring(0,o.indexOf(":"));-1===n.inArray(r,e)&&e.push(r)}),$.getSnapshot(e).then(function(e){return $.lastSnapshot=e,b(e)}).then(function(e){n.each(J,function(n,t){t(e)}),O("accountUpdated",e),Y=!1},function(){Y=!1})}}function b(e){var t=new n.Deferred;if(a())t.resolve(e);else{var o=[],r=function(e,n){p(n.instrumentId)||o.push(n.instrumentId)};n(e.positions.open).each(r),n(e.orders.pending).each(r),o.length?$.getInstrumentsFromIds(o).then(function(){t.resolve(e)}):t.resolve(e)}return t}function T(){$.tradingEnabled=!1,o()&&localStorage.setItem("tradingEnabled:"+R,!1),n(H).each(function(e,n){n()}),O("tokenExpired"),v()}function y(e){n(X).each(function(n,t){t(e)}),O("error",e)}function E(){n(V).each(function(e,n){n()}),O("accountSwitch")}function O(e,n){if($.isEventValid(e)){if(void 0!==typeof B[e])for(var t in B[e])"undefined"!=typeof n?B[e][t](n):B[e][t]()}else console.error("Careful, can't notify '"+e+"', it's an invalid event name")}function k(e,n,t){return n||t?e.then(function(e){return"function"==typeof n?n(e):void 0},function(e,n,o){return"function"==typeof t?t(e,n,o):void 0}):e}function P(){var e=new n.Deferred;if(!$.tradingEnabled||$.selectedAccount.brokerId<0&&1===$.allAccounts.length)return e.resolve(),e;var t={tokenValue:$.accessToken};return $.makeOsRequest("internal","POST","","signOut",t).then(function(){e.resolve()},function(){e.reject()}),e}function S(e){var n,t,o=0;if(0===e.length)return o;for(n=0;n<e.length;n++)t=e.charCodeAt(n),o=(o<<5)-o+t,o&=o;return o}function w(){return-1!=navigator.userAgent.indexOf("MSIE")||/rv:11.0/i.test(navigator.userAgent)}"undefined"!=typeof console&&"undefined"!=typeof console.log||(e.console={log:function(){}});var R,F,U,C="js-1.15.4",q=location.href;if("undefined"!=typeof tradableEmbedConfig)R=tradableEmbedConfig.appId,F=tradableEmbedConfig.customOAuthURL,U=tradableEmbedConfig.customOAuthHost,tradableEmbedConfig.redirectURI&&(q=tradableEmbedConfig.redirectURI);else{var x="tradable-embed";0===n("#"+x).length&&(x="tradable-api"),R=n("#"+x).attr("data-app-id"),F=n("#"+x).attr("data-custom-oauth-url"),U=n("#"+x).attr("data-custom-oauth-host");var L=n("#"+x).attr("data-redirect-uri");L&&(q=L)}q=encodeURIComponent(q);var D="api.tradable.com/";R>2e5&&(D="api-staging.tradable.com/",console.log("Starting in staging mode...")),U&&(D=U);var M="https://"+D+"oauth/authorize?client_id="+R+"&scope=trade&response_type=token&redirect_uri="+q,_=F?F:M,j=localStorage.getItem("accessToken:"+R),N=localStorage.getItem("authEndpoint:"+R),G=localStorage.getItem("tradingEnabled:"+R),W=localStorage.getItem("expirationTimeUTC:"+R);!G||N&&j&&W||(G=!1,o()&&localStorage.setItem("tradingEnabled:"+R,G));var K=["embedReady","accountUpdated","accountSwitch","tokenExpired","tokenWillExpire","error"],B={},V=[],J=[],Q=[],H=[],z=[],X=[],Y=!1,$={version:"1.15.4",app_id:R,oauth_host:D,auth_loc:_,login_loc:_+"&showLogin=true",approval_page_loc:_+"&showApproval=true",broker_signup_loc:"https://"+D+"brokerSignup?client_id="+R+"&redirect_uri="+q,auth_window:null,authEndpoint:N,accessToken:j,notifiedCallbacks:!1,tradingEnabled:G,expirationTimeUTC:W,readyCallbacks:[],allAccounts:[],accounts:[],accountIdsToExclude:[],accountMap:{},selectedAccount:null,selectedAccountId:null,availableCategories:[],availableInstruments:[],availableSymbols:[],availableCurrencies:[],lastSnapshot:null,instrumentKeysForAccountUpdates:[],accountUpdateMillis:700,showApprovalPage:function(){$.openOAuthPage("APPROVAL",!0)},showApprovalPageInWindow:function(){$.openOAuthPage("APPROVAL",!1)},authenticate:function(e){$.tradingEnabled?g():$.openOAuthPage("AUTHENTICATE",!0,e)},authenticateWithWindow:function(e){$.openOAuthPage("AUTHENTICATE",!1,e)},showLoginPage:function(e){$.openOAuthPage("LOGIN",!0,e)},showLoginPageInWindow:function(e){$.openOAuthPage("LOGIN",!1,e)},showBrokerSignUpPage:function(){$.openOAuthPage("BROKER_SIGNUP",!0)},showBrokerSignUpPageInWindow:function(){$.openOAuthPage("BROKER_SIGNUP",!1)},openOAuthPage:function(e,n,t){var o="AUTHENTICATE"===e.toUpperCase()?$.auth_loc:"LOGIN"===e.toUpperCase()?$.login_loc:"APPROVAL"===e.toUpperCase()?$.approval_page_loc:"BROKER_SIGNUP"===e.toUpperCase()?$.broker_signup_loc:void 0;if(!o)return void console.error("Choose a correct type: AUTHENTICATE, LOGIN, APPROVAL or BROKER_SIGNUP");if("undefined"!=typeof t&&(o=o+"&broker_id="+t),"undefined"!=typeof n&&n||w())location.href=o;else{var c="BROKER_SIGNUP"===e.toUpperCase()?"osBrokerSignUp":"osLaunch";$.auth_window=r(o,c)}},enableWithAccessToken:function(e,n,t){$.enableTrading(e,n,t,!0)},signOut:function(){P(),o()&&(localStorage.removeItem("accessToken:"+R),localStorage.removeItem("authEndpoint:"+R),localStorage.removeItem("tradingEnabled:"+R),localStorage.removeItem("expirationTimeUTC:"+R)),$.tradingEnabled=!1,v()},isEventValid:function(e){return"string"==typeof e&&-1!==n.inArray(e,K)},on:function(e,n,t){if(!$.isEventValid(n))return void console.error("Plase provide a valid eventName: "+K);if(B[n]||(B[n]={}),"string"!=typeof e)return void console.error("The given event namespace is invalid (needs to be a string)");if("undefined"!=typeof B[n][e])return void console.error("The given event namespace is already taken, 'off' the event first to change it");if("function"!=typeof t)return void console.error("Please provide a valid callback function");switch(n){case"embedReady":$.initEmbedReady(t);break;case"accountUpdated":$.initAccountUpdated();break;case"tokenWillExpire":$.initTokenWillExpire()}B[n][e]=t},off:function(e,n){if("undefined"==typeof n)for(var t in B)e in B[t]&&delete B[t][e];else $.isEventValid(n)&&B[n]&&e in B[n]&&delete B[n][e]},initEmbedReady:function(e){$.notifiedCallbacks&&e()},onEmbedReady:function(e){$.readyCallbacks.push(e),$.initEmbedReady(e)},accountUpdateInterval:null,initAccountUpdated:function(){null===$.accountUpdateInterval&&($.accountUpdateInterval=setInterval(I,$.accountUpdateMillis))},onAccountUpdated:function(e){if(e){$.initAccountUpdated();var t=S(e.toString());-1===n.inArray(t,Q)&&(J.push(e),Q.push(t))}},setAccountUpdateFrequencyMillis:function(e){e&&e>0&&"number"==typeof e?($.accountUpdateMillis=e,$.accountUpdateInterval&&(clearInterval($.accountUpdateInterval),$.accountUpdateInterval=setInterval(I,$.accountUpdateMillis))):console.error("Please specify a valid update frequency")},addSymbolToUpdates:function(e,n){console.warn("'addSymbolToUpdates' is now deprecated, 'addInstrumentIdToUpdates' should now be used instead."),$.addInstrumentIdToUpdates(e,n)},removeSymbolFromUpdates:function(e,n){console.warn("'removeSymbolFromUpdates' is now deprecated, 'removeInstrumentIdFromUpdates' should now be used instead."),$.removeInstrumentIdFromUpdates(e,n)},addInstrumentIdToUpdates:function(e,t){if(-1!==e.indexOf(":"))return void console.error("It is not allowed to include a colon ':' in the updateClientId");var o=t+":"+e;-1===n.inArray(o,$.instrumentKeysForAccountUpdates)&&$.instrumentKeysForAccountUpdates.push(o)},removeInstrumentIdFromUpdates:function(e,t){var o=t+":"+e;$.instrumentKeysForAccountUpdates=n.grep($.instrumentKeysForAccountUpdates,function(e){return e!=o})},onAccountSwitch:function(e){e&&-1===n.inArray(e,V)&&V.push(e)},onTokenExpired:function(e){e&&-1===n.inArray(e,H)&&H.push(e)},onError:function(e){-1===n.inArray(e,X)&&X.push(e)},tokenWillExpireInterval:null,initTokenWillExpire:function(){function e(){var e=$.getRemainingTokenMillis();e&&e>0&&18e5>e&&(n(z).each(function(n,t){t(e)}),O("tokenWillExpire",e))}null===$.tokenWillExpireInterval&&($.tokenWillExpireInterval=setInterval(e,3e5))},onTokenWillExpire:function(e){$.initTokenWillExpire(),-1===n.inArray(e,z)&&z.push(e)},getRemainingTokenMillis:function(){return $.expirationTimeUTC||console.log("You need to authenticate before calling this method"),$.expirationTimeUTC-(new Date).getTime()},makeOsRequest:function(e,t,o,r,c,i,u){var a,s="internal"===e?"":"v1/";"user"!==e&&"accounts"!==e?a="https://"+D:void 0!==o&&null!==o&&0===o.length?a=$.authEndpoint:$.accountMap[o]?a=$.accountMap[o].endpointURL:console.info("Please specify a valid accountId or method");var l=n.ajax({type:t,beforeSend:function(n){"internal"!==e&&n.setRequestHeader("Authorization","Bearer "+$.accessToken),n.setRequestHeader("x-tr-embed-sdk",C)},crossDomain:!0,xhrFields:{withCredentials:!0},url:o&&o.length>0?a+s+e+"/"+o+"/"+r:a+s+e+"/"+r,contentType:"application/json; charset=utf-8",data:c?JSON.stringify(c):void 0,dataType:"json"});return l.then(function(){},function(e,n,t){e.responseJSON&&(403!==e.responseJSON.httpStatus&&502!==e.responseJSON.httpStatus||T(),y(e.responseJSON))}),i||u?l.then(function(e){return"function"==typeof i?i(e):void 0},function(e,n,t){return"function"==typeof u?u(e,n,t):void 0}):"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?Promise.resolve(l):l},makeAccountRequest:function(e,n,t,o,r,c){return $.makeOsRequest("accounts",e,n,t,o,r,c)},setSelectedAccount:function(e,n,t){return $.accountMap[e]?($.lastSnapshot=void 0,$.selectedAccount=$.accountMap[e],$.selectedAccountId=e,console.log("New accountId is set"),c(function(){o()&&localStorage.setItem("selectedAccount:"+R,e),n&&n()},function(e){502!==e.status&&500!==e.status&&403!==e.status||($.excludeCurrentAccount(),$.accounts.length>0?g():$.signOut()),t&&t(e)})):void console.error("Can't set account id to: "+e)},excludeCurrentAccount:function(){var e=$.selectedAccountId,n=$.accounts.indexOf($.selectedAccount);n>-1&&$.accounts.splice(n,1),delete $.accountMap[e],$.accountIdsToExclude.push(e)},getInstrumentFromSymbol:function(e){if(!e)return null;var t=null;return n($.availableInstruments).each(function(n,o){return o.symbol.toUpperCase()===e.toUpperCase()?(t=o,!1):void 0}),t},getInstrumentFromId:function(e){if(!e)return null;var t=null;return p(e)?(n($.availableInstruments).each(function(n,o){return o.instrumentId.toUpperCase()===e.toUpperCase()?(t=o,!1):void 0}),t):(console.warn("Instrument Id not found..."),null)},getInstrumentFromBrokerageAccountSymbol:function(e){var t=null;return n($.availableInstruments).each(function(n,o){return o.brokerageAccountSymbol.toUpperCase()===e.toUpperCase()?(t=o,!1):void 0}),t},getAccountById:function(e){return $.accountMap[e]},getUser:function(e,n){return $.makeOsRequest("user","GET","","",null,e,n)},getAppInfo:function(e,n){return $.makeOsRequest("apps","GET","",$.app_id,null,e,n)},getBrokers:function(e,n){return $.makeOsRequest("brokers","GET","","",null,e,n)},authenticateWithCredentials:function(e,t,o,r,c){var i,u=new n.Deferred,a={appId:$.app_id,brokerId:e,login:t,password:o};return $.makeOsRequest("authenticate","POST","","",a).then(function(e){return i=e,$.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){u.resolve(i)},function(e){u.reject(e)}),k(u,r,c)},createDemoAccount:function(e,t,o){var r,c=new n.Deferred,i={appId:$.app_id,type:e};return $.makeOsRequest("createDemoAccount","POST","","",i).then(function(e){return r=e,$.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){c.resolve(r)},function(e){c.reject(e)}),k(c,t,o)},createForexDemoAccount:function(e,n){return $.createDemoAccount("FOREX",e,n)},createStocksDemoAccount:function(e,n){return $.createDemoAccount("STOCKS",e,n)},refreshAuthentication:function(e,t,o,r){var c=new n.Deferred,i={refreshTokenValue:e};t&&(i={refreshTokenValue:e,appSecret:t});var u;return $.makeOsRequest("refreshAuthentication","POST","","",i).then(function(e){return u=e,$.enableTrading(e.apiTokenValue,e.apiEndpoint,e.expires)}).then(function(){c.resolve(u)},function(e){c.reject(e)}),k(c,o,r)},getAccounts:function(e,t){var o=$.makeAccountRequest("GET","","",null).then(function(e){$.accounts.splice(0,$.accounts.length),$.allAccounts.splice(0,$.allAccounts.length),$.accountMap={},n(e.accounts).each(function(e,n){n.uniqueId&&"NA"!==n.uniqueId&&$.accountIdsToExclude.indexOf(n.uniqueId)<=-1&&($.accounts.push(n),$.accountMap[n.uniqueId]=n),$.allAccounts.push(n)})});return k(o,e,t)},getCandles:function(e,n,t,o,r,c){return $.getCandlesForAccount($.selectedAccountId,e,n,t,o,r,c)},getCandlesForAccount:function(e,n,t,o,r,c,i){var u={instrumentId:n,from:t,to:o,aggregation:r};return $.makeAccountRequest("POST",e,"candles/",u,c,i)},getSnapshot:function(e,n,t){return $.getSnapshotForAccount($.selectedAccountId,e,n,t)},getSnapshotForAccount:function(e,n,t,o){var r={instrumentIds:n,includeMarginFactors:!1};return $.makeAccountRequest("POST",e,"",r,t,o)},getInstrumentsFromIds:function(e,n,t){return $.getInstrumentsFromIdsForAccount($.selectedAccountId,e,n,t)},getInstrumentsFromIdsForAccount:function(e,t,o,r){function c(e,t){var o=null;return n(t).each(function(n,t){return t.instrumentId.toUpperCase()===e.toUpperCase()?(o=t,!1):void 0}),o}var i=new n.Deferred,a=[];s(e)||n(t).each(function(e,n){p(n)||a.push(n)});var l=new n.Deferred;if(a.length){var d={instrumentIds:a};$.makeAccountRequest("POST",e,"instruments/",d).then(function(e){m(e.instruments),l.resolve($.availableInstruments)})}else $.selectedAccount&&e===$.selectedAccount.uniqueId?l.resolve($.availableInstruments):u(e).then(function(e){l.resolve(e)},function(e){i.reject(e)});return l.then(function(e){var o=[];n(t).each(function(n,t){var r=c(t,e);r&&o.push(r)}),i.resolve({instruments:o})},function(e){i.reject(e)}),k(i,o,r)},searchInstruments:function(e,n,t){return $.searchInstrumentsForAccount($.selectedAccountId,e,n,t)},searchInstrumentsForAccount:function(e,t,o,r){function c(e,t){var o=new RegExp(i(t),"i"),r=n.grep(e,function(e){return o.test(e.symbol)||o.test(e.brokerageAccountSymbol)||o.test(e.displayName)||o.test(e.type)});return r}function i(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(e){var t=n.extend({},e),o=["instrumentId","symbol","brokerageAccountSymbol","displayName","shortDescription","type"],r=[];for(var c in t)n.inArray(c,o)<0&&r.push(c);return n(r).each(function(e,n){delete t[n]}),t}var l=new n.Deferred;if(s(e)){var d=new n.Deferred;$.selectedAccount&&e===$.selectedAccount.uniqueId?d.resolve($.availableInstruments):u(e).then(function(e){d.resolve(e)},function(e){l.reject(e)}),d.then(function(e){var o=c(e,t),r=[];n(o).each(function(e,n){r.push(a(n))}),l.resolve(r)},function(e){l.reject(e)})}else{var f={query:t};t.length<2?l.resolve([]):$.makeAccountRequest("POST",e,"instrumentsearch/",f).then(function(e){l.resolve(e.instruments)},function(e){l.reject(e)})}return k(l,o,r)},getMetrics:function(e,n){return $.getMetricsForAccount($.selectedAccountId,e,n)},getMetricsForAccount:function(e,n,t){return $.makeAccountRequest("GET",e,"metrics/",null,n,t)},getOrders:function(e,n){return $.getOrdersForAccount($.selectedAccountId,e,n)},getOrdersForAccount:function(e,n,t){return $.makeAccountRequest("GET",e,"orders/",null,n,t)},placeMarketOrder:function(e,n,t,o,r){return $.placeOrder(e,0,n,t,"MARKET",o,r)},placeMarketOrderForAccount:function(e,n,t,o,r,c){return $.placeOrderForAccount(e,n,0,t,o,"MARKET",r,c)},placeLimitOrder:function(e,n,t,o,r,c){return $.placeOrder(e,n,t,o,"LIMIT",r,c)},placeLimitOrderForAccount:function(e,n,t,o,r,c,i){return $.placeOrderForAccount(e,n,t,o,r,"LIMIT",c,i)},placeStopOrder:function(e,n,t,o,r,c){return $.placeOrder(e,n,t,o,"STOP",r,c)},placeStopOrderForAccount:function(e,n,t,o,r,c,i){return $.placeOrderForAccount(e,n,t,o,r,"STOP",c,i)},placeOrder:function(e,n,t,o,r,c,i){return $.placeOrderForAccount($.selectedAccountId,e,n,t,o,r,c,i)},placeOrderForAccount:function(e,n,t,o,r,c,i,u){var a={amount:n,price:t,side:o,instrumentId:r,type:c};return $.makeAccountRequest("POST",e,"orders/",a,i,u)},placeOrderWithProtections:function(e,n,t,o,r,c,i,u,a){return $.placeOrderWithProtectionsForAccount($.selectedAccountId,e,n,t,o,r,c,i,u,a)},placeOrderWithProtectionsForAccount:function(e,n,t,o,r,c,i,u,a,s){var l={amount:n,price:t,side:o,instrumentId:r,type:c};return i&&(l.takeProfitDistance=i),u&&(l.stopLossDistance=u),$.makeAccountRequest("POST",e,"orders/",l,a,s)},getPendingOrders:function(e,n){return $.getPendingOrdersForAccount($.selectedAccountId,e,n)},getPendingOrdersForAccount:function(e,n,t){return $.makeAccountRequest("GET",e,"orders/pending",null,n,t)},getOrderById:function(e,n,t){return $.getOrderByIdForAccount($.selectedAccountId,e,n,t)},getOrderByIdForAccount:function(e,n,t,o){return $.makeAccountRequest("GET",e,"orders/"+n,null,t,o)},modifyOrderPrice:function(e,n,t,o){return $.modifyOrderPriceForAccount($.selectedAccountId,e,n,t,o)},modifyOrderPriceForAccount:function(e,n,t,o,r){var c={price:t};return $.makeAccountRequest("PUT",e,"orders/"+n,c,o,r)},cancelOrder:function(e,n,t){return $.cancelOrderForAccount($.selectedAccountId,e,n,t)},cancelOrderForAccount:function(e,n,t,o){return $.makeAccountRequest("DELETE",e,"orders/"+n,null,t,o)},getPositions:function(e,n){return $.getPositionsForAccount($.selectedAccountId,e,n)},getPositionsForAccount:function(e,n,t){return $.makeAccountRequest("GET",e,"positions/",null,n,t)},closeAllPositions:function(e,n){return $.closeAllPositionsForAccount($.selectedAccountId,e,n)},closeAllPositionsForAccount:function(e,n,t){return $.makeAccountRequest("DELETE",e,"positions/",null,n,t)},getOpenPositions:function(e,n){return $.getOpenPositionsForAccount($.selectedAccountId,e,n)},getOpenPositionsForAccount:function(e,n,t){return $.makeAccountRequest("GET",e,"positions/open",null,n,t)},getPositionById:function(e,n,t){return $.getPositionByIdForAccount($.selectedAccountId,e,n,t)},getPositionByIdForAccount:function(e,n,t,o){return $.makeAccountRequest("GET",e,"positions/"+n,null,t,o)},reducePositionToAmount:function(e,n,t,o){return $.reducePositionToAmountForAccount($.selectedAccountId,e,n,t,o)},reducePositionToAmountForAccount:function(e,n,t,o,r){var c={amount:t};return $.makeAccountRequest("PUT",e,"positions/"+n,c,o,r)},closePosition:function(e,n,t){return $.closePositionForAccount($.selectedAccountId,e,n,t)},closePositionForAccount:function(e,n,t,o){return $.makeAccountRequest("DELETE",e,"positions/"+n,null,t,o)},addOrModifyProtections:function(e,n,t,o,r){return $.addOrModifyProtectionsForAccount($.selectedAccountId,e,n,t,o,r)},addOrModifyProtectionsForAccount:function(e,n,t,o,r,c){var i={};return null!==t&&(i.takeprofit=t),null!==o&&(i.stoploss=o),$.makeAccountRequest("PUT",e,"positions/"+n+"/protections/",i,r,c)},cancelProtections:function(e,n,t){return $.cancelProtectionsForAccount($.selectedAccountId,e,n,t)},cancelProtectionsForAccount:function(e,n,t,o){return $.makeAccountRequest("DELETE",e,"positions/"+n+"/protections/",null,t,o)},addOrModifyTakeProfit:function(e,n,t,o){return $.makeProtectionRequest("PUT",e,n,"TAKEPROFIT",t,o)},addOrModifyTakeProfitForAccount:function(e,n,t,o,r){return $.makeProtectionRequestForAccount("PUT",e,n,t,"TAKEPROFIT",o,r)},addOrModifyStopLoss:function(e,n,t,o){return $.makeProtectionRequest("PUT",e,n,"STOPLOSS",t,o)},addOrModifyStopLossForAccount:function(e,n,t,o,r){return $.makeProtectionRequestForAccount("PUT",e,n,t,"STOPLOSS",o,r)},cancelTakeProfit:function(e,n,t){return $.makeProtectionRequest("DELETE",e,0,"TAKEPROFIT",n,t)},cancelTakeProfitForAccount:function(e,n,t,o){return $.makeProtectionRequestForAccount("DELETE",e,n,0,"TAKEPROFIT",t,o)},cancelStopLoss:function(e,n,t){return $.makeProtectionRequest("DELETE",e,0,"STOPLOSS",n,t)},cancelStopLossForAccount:function(e,n,t,o){return $.makeProtectionRequestForAccount("DELETE",e,n,0,"STOPLOSS",t,o)},makeProtectionRequest:function(e,n,t,o,r,c){return $.makeProtectionRequestForAccount(e,$.selectedAccountId,n,t,o,r,c)},makeProtectionRequestForAccount:function(e,n,t,o,r,c,i){var u={price:o};return"DELETE"===e&&(u=null),$.makeAccountRequest(e,n,"positions/"+t+"/protections/"+r,u,c,i)},getPrices:function(e,n,t){return $.getPricesForAccount($.selectedAccountId,e,n,t)},getPricesForAccount:function(e,t,o,r){var c={instrumentIds:t};if(s(e)||e!==$.selectedAccount.uniqueId)return $.makeAccountRequest("POST",e,"prices/",c,o,r);var i=new n.Deferred,u=[];n(t).each(function(e,n){p(n)||u.push(n)});var a;return a=u.length?$.getInstrumentsFromIdsForAccount(e,u).then(function(){return $.makeAccountRequest("POST",e,"prices/",c)}):$.makeAccountRequest("POST",e,"prices/",c),a.then(function(e){i.resolve(e)},function(e){i.reject(e)}),k(i,o,r)},makeCandleRequest:function(e,t,o,r,c){var i={symbols:t};c&&(i=c);var u=n.ajax({type:"POST",crossDomain:!0,url:"https://candles-api.tradable.com/"+e,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),dataType:"json"});if(o||r)return u.then(function(e){return"function"==typeof o?o(e.dailyClose?e.dailyClose:e):void 0},function(e,n,t){return"function"==typeof r?r(e,n,t):void 0});var a=new n.Deferred;return u.then(function(e){return e.dailyClose?a.resolve(e.dailyClose):a.resolve(e)},function(e,n,t){return a.reject(e,n,t)}),"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?Promise.resolve(a.promise()):a.promise()},getLastDailyClose:function(e,n,t){return $.makeCandleRequest("dailyClose",e,n,t)},initializeWithToken:function(e,n,t,r,c){e&&n&&($.accessToken=e,$.authEndpoint=n,o()&&(localStorage.setItem("accessToken:"+R,$.accessToken),localStorage.setItem("authEndpoint:"+R,$.authEndpoint),t&&($.expirationTimeUTC=(new Date).getTime()+1e3*parseInt(t),localStorage.setItem("expirationTimeUTC:"+R,$.expirationTimeUTC))));var i=$.getAccounts();return k(i,r,c)},enableTrading:function(e,t,o,r){var c=new n.Deferred;console.log("Enabling Trading..."),$.tradingEnabled=!1,$.lastSnapshot=void 0;var i=$.accounts.length;return $.initializeWithToken(e,t,o).then(function(e){return A(r,i)}).then(function(){c.resolve()},function(e){c.reject(e)}),c}};t();var Z=[],ee={};e.trEmbJQ=trEmbJQ,e.tradableEmbed=$,"function"==typeof require&&"object"==typeof module&&module&&module.exports&&(module.exports=$)}(jsGlobalObject,trEmbJQ);